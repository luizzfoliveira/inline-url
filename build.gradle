/*
 * This file was generated by the Gradle 'init' task.
 *
 * This is a general purpose Gradle build.
 * Learn more about Gradle by exploring our samples at https://docs.gradle.org/7.6/samples
 * This project uses @Incubating APIs which are subject to change.
 */
plugins {
    id 'dev.clojurephant.clojure' version '0.7.0'
    id 'org.jetbrains.intellij' version '1.5.2'
    id 'org.jetbrains.kotlin.jvm' version '1.8.10'
}

group = 'carvalhedo' // the group ID your artifacts should be published under
version = '0.2.0' // the version your artifacts should be published under

repositories {
    mavenCentral()
    maven {
        name = 'Clojars' // name can be ommitted, but is helpful in troubleshooting
        url = 'https://repo.clojars.org/'
    }
}

// Configure Gradle IntelliJ Plugin - read more: https://github.com/JetBrains/gradle-intellij-plugin
intellij {
    version = "2021.1"
    type = "IC"
}

dependencies {
    implementation 'cheshire:cheshire:5.11.0'

    implementation 'org.clojure:clojure:1.11.1'

    // due to how clojure.test is executed, a JUnit test engine (Jovial) is needed
    testRuntimeOnly 'org.ajoberstar:jovial:0.3.0'

    // due to the way Gradle's REPL is started, if you need tools.namespace, you must be on 0.3+
    devImplementation 'org.clojure:tools.namespace:1.3.0'
}

// due to how clojure.test is executed, the JUnit platform is needed
tasks.withType(Test) {
    useJUnitPlatform()
}

tasks {
    patchPluginXml {
        sinceBuild = "212"
        untilBuild = "222.*"
    }

    signPlugin {
        certificateChain = System.getenv("CERTIFICATE_CHAIN")
        privateKey = System.getenv("PRIVATE_KEY")
        password = System.getenv("PRIVATE_KEY_PASSWORD")
    }

    publishPlugin {
        token = System.getenv("PUBLISH_TOKEN")
    }
}

sourceCompatibility = 1.8
targetCompatibility = 1.8
